<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title id="pageTitle">♬曲をリクエストする</title>
  <link rel="stylesheet" href="style.css">
  <script src="skript.js" defer></script>
</head>
<body onload="checkRecruitingStatus()">
  <button class="admin-button" onclick="showAdminLogin()">管理者用</button>
  <div class="container" id="mainContainer">
    <h1 id="frontendTitle">♬曲をリクエストする</h1>
    <div class="button-container">
      <button id="modeSong" onclick="setSearchMode('song')">曲名(アーティスト)で検索</button>
      <button id="modeArtist" onclick="setSearchMode('artist')">アーティストから検索</button>
    </div>
    <div id="artistInputContainer" class="input-container">
      <input type="text" id="artistName" placeholder="アーティスト名を入力">
      <button class="input-clear-btn" onclick="clearInput('artistName')">×</button>
    </div>
    <div class="input-container">
      <input type="text" id="songName" placeholder="曲名を入力" oninput="searchSongs()">
      <button class="input-clear-btn" onclick="clearInput('songName')">×</button>
    </div>
    <div id="reSearchSongMode"><button onclick="reSearch()">再検索</button></div>
    <div id="reSearchArtistMode" style="display:none"><button onclick="reSearch()">再検索</button></div>
    <div id="loadingIndicator">
      <div class="loading-spinner"></div>
      <div class="loading-text">読み込み中</div>
    </div>
    <div id="suggestions"></div>
    <div id="selectedLabel"></div>
    <div id="selectedArtist"></div>
    <div id="selectedSong"></div>
    <form id="requestForm" action="/submit" method="post" onsubmit="handleSubmit(event)"></form>
  </div>
  <p class="privacy-note">個人情報は収集されません。</p>
  <script>
    function checkRecruitingStatus() {
      fetch("/settings")
        .then(r => r.json())
        .then(d => {
          document.getElementById("frontendTitle").innerText = d.frontendTitle;
          document.getElementById("pageTitle").innerText = d.frontendTitle;
          if (!d.recruiting) {
            document.getElementById("mainContainer").innerHTML = `<p style="color:red;font-size:1.2em;">現在は募集していません</p>`;
          }
        });
    }
  </script>
</body>
</html>
